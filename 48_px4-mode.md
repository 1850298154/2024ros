---
created: 2024-01-30T16:53:15 (UTC +08:00)
tags: [固定翼,HEADER,俯仰角,TRUE,垂直起降,多旋翼,任务模式,GPS,VTOL,设定值,WIDTH,自动驾驶仪,飞行模式,极端天气,控制车,曲线形,前后方,无人机,CLASS,着陆点,SIZE,Android,控制组,旋翼机,MISSION,水平面,ALT,遥控器,激光雷达,其他来源,预定义,相机镜头,安全须知,弹射器,全球定位,自动驾驶,飞行器,估计值,起始地,HTTPS,gcs,qgc,游戏手柄,传感器,加速度,里程计,可以使,如上所述,逆时针,SD卡]
source: https://www.bilibili.com/read/cv27487546/?jump_opus=1
author: 超维空间科技
---

# PX4飞行模式 - 哔哩哔哩

> ## Excerpt
> 文章目录 · 前言 · 飞行模式切换 · 自主和手动模式 · 不同机型支持的飞行模式 · 位置模式（多旋翼） · 技术摘要 · 参数 · 位置丢失/安全 · 定高模式（多旋翼） · 技术总结 · 参数 · 手动/自稳模式（多旋翼） · 技术描述 · 参数 · 特技模式（多旋翼） · 技术描述 · 摇杆输入映射 · 参数 · 环绕模式 （多旋翼） · 参数/限制 · 定点模式（固定翼） · 定高模式（固定翼） · 技术总结 · 参数 · 自稳模式（固定翼） · 技术描述 · 特技模式（固定翼） · 技术描述

---
**文章目录**

· <u>前言</u>

· <u>飞行模式切换</u>

· <u>自主和手动模式</u>

· 不同机型支持的飞行模式

· <u>位置模式（多旋翼）</u>

· <u>技术摘要</u>

· <u>参数</u>

· <u>位置丢失/安全</u>

· <u>定高模式（多旋翼）</u>

· <u>技术总结</u>

· <u>参数</u>

· <u>手动/自稳模式（多旋翼）</u>

· <u>技术描述</u>

· <u>参数</u>

· <u>特技模式（多旋翼）</u>

· <u>技术描述</u>

· <u>摇杆输入映射</u>

· <u>参数</u>

· <u>环绕模式 （多旋翼）</u>

· <u>参数/限制</u>

· <u>定点模式（固定翼）</u>

· <u>定高模式（固定翼）</u>

· <u>技术总结</u>

· <u>参数</u>

· <u>自稳模式（固定翼）</u>

· <u>技术描述</u>

· <u>特技模式（固定翼）</u>

· <u>技术描述</u>

· <u>参数</u>

· <u>手动模式（固定翼）</u>

· <u>技术描述</u>

· <u>参数</u>

· <u>起飞模式</u>

· <u>多旋翼（MC）</u>

· <u>固定翼（FW）</u>

· <u>着陆模式</u>

· <u>多旋翼（MC）</u>

· <u>固定翼（FW）</u>

· <u>返航模式</u>

· <u>返航类型（RTL_TYPE）</u>

· <u>起始位置/集结点返航类型（RTL_TYPE=0）</u>

· <u>任务着陆/集结点返航类型 (RTL_TYPE=1)</u>

· <u>保持模式</u>

· <u>多旋翼（MC）</u>

· <u>固定翼（FW）</u>

· <u>垂直起降（VTOL）</u>

· <u>任务模式</u>

· <u>参数描述</u>

· <u>跟随模式</u>

· <u>安全须知</u>

· <u>通过QGroundControl使用跟随模式</u>

· <u>通过MAVSDK使用跟随模式</u>

· <u>参数</u>

· <u>提示和技巧</u>

· <u>Offboard 模式</u>

· <u>描述</u>

· <u>支持的消息</u>

· <u>多旋翼/垂直起降</u>

· <u>Offboard参数</u>

## **前言**

飞行模式定义了自驾仪如何响应遥控输入，以及它如何在全自主飞行期间管理飞行器运动。

这些模式为用户提供不同类型/级别的自动驾驶辅助，包括从起飞和着陆等常见任务的自动化。

## **飞行模式切换**

飞行员可以使用遥控上的开关或地面站来切换飞行模式。

并非所有飞行器都可以使用所有飞行模式，并且某些模式在不同飞行器类型上表现不同。

一些飞行模式仅在飞行前和飞行中某些特定条件下起作用（如 GPS 锁定，空速传感器，某个轴的姿态感测）。 除非满足合适的条件，否则 PX4 不会允许切换到这些模式。

在多旋翼自主模式下，遥控器摇杆移动将默认将车辆更改为位置模式（除非处理关键的电池故障保护）。对于自主固定翼飞行，操纵杆运动被忽略。

## **自主和手动模式**

一般来说，飞行模式是手动或自主的。手动模式是指用户通过遥控操纵杆（或操纵杆）控制车辆移动的模式，而自主模式完全由自动驾驶仪控制，不需要遥控控制输入。

提示

某些手动模式可能具有自驾辅助机制，以便更容易获得或恢复受控飞行。 如当遥控摇杆居中时，大部分飞行模式将使飞行器水平。

手动模式可以进一步分为 “自稳” 和 ”特技“ 模式。 在自稳模式下，滚动和俯仰杆设置车辆角度，从而在水平面上左右和前后移动。这将不仅可以使运动变得可预测，而且因为角度受控，飞行器无法翻转。 在特技模式中，RC 摇杆控制角度旋转的速率（绕相应轴）。飞行器可以翻转，虽然机动性更强，但更难飞行。

## **不同机型支持的飞行模式**

固定翼:

手动：自稳，位置，高度，特技

自动：保持, 返航, 任务, 起飞, 降落, Offboard

多旋翼:

手动：自稳，位置，高度，特技

自动：保持, 返航, 任务, 起飞, 降落, 跟随，Offboard

## **位置模式（多旋翼）**

\[飞行难度：简单\] \[需要手动/遥控器控制\] \[需要定位锁定（例如GPS）\]

位置是一种易于飞行的RC模式，其中滚动和俯仰杆控制车辆左右和前后方向上的地面加速度（类似于汽车的油门），油门控制升降速度。当摇杆释放/居中时，机体将主动制动，保持水平，并锁定到 3D 空间中的位置 — 补偿风和其他力。 摇杆打满时，机体以MPC\_ACC\_HOR\_MAX开始加速到达最终的速度MPC\_VEL\_MANUAL。

提示

位置模式对于新手是最安全的手动模式。 不同于定高模式和手动/自稳模式，机体在摇杆中位时会停止，而不是继续直到风阻使其减速。 :::

下图直观地显示了遥感对应的操作（对于美国手的遥控器）。

![read-normal-img](https://i0.hdslb.com/bfs/article/760e0dd1baa0a1a1cb377fa8cc0d84ec479817593.png@progressive.webp)

该模式中降落是很容易的：

使用横滚和俯仰杆控制无人机水平位置于降落点上方。

松开横滚和俯仰杆并给予足够的时间使其完全停止。

轻轻下拉油门杆直到机体触碰地面。

将油门杆一直向下拉以促进和加快着陆检测。

机体将降低螺旋桨推力，检测地面并自动落锁（默认）。

注意

虽然在校准良好的机体上非常罕见，但有时着陆可能会出现问题。

如果机体无法停止水平移动：

您仍然可以在高度模式下在控制降落。 方法与上述相同，除了您必须使用横滚和俯仰杆手动确保机体保持在降落点上方。

降落后检查 GPS 和磁罗盘方向，并校准。

如果机体未检测到地面/降落并自动加锁。可以等机体落地后切换到手动/自稳模式，保持油门杆低位，并使用遥控器手动落锁。 或者，当机体已经在地面上时，您也可以使用刹车开关。

## **技术摘要**

遥控模式下，横滚、俯仰、油门 (RPT) 杆控制相应轴/方向的运动。 摇杆居中使机体水平并将其保持在固定的高度和位置并抗风。

摇杆处于滚动、俯仰、油门杆中位（遥控死区MPC\_HOLD\_DZ内）时，机体保持 x、y、z 位置稳定，抵抗任意干扰，如风。

中位以外：

横滚/俯仰杆控制机体左右和前后方向（分别）在地面上的水平加速度。

油门杆控制上升下降速度。

偏航杆控制水平面上方的角旋转速率。

起飞：

在地面时，如果油门杆升高到 62.5% 以上（从底部的全范围），机体将起飞。

注解

遥控输入信号是必须的（遥控器，或通过 MAVLink 的游戏手柄/拇指摇杆）。

此模式需要 GPS。

## **参数**

多旋翼位置控制组的所有参数都与位置模式有关。 下面列出了一些特别值得注意的参数。

参数 描述

MPC\_HOLD\_DZ 启用位置保持的摇杆死区。 默认值：0.1（摇杆全行程的 10％）。

MPC\_Z\_VEL\_MAX\_UP 最大垂直上升速度。 默认：3 m/s。

MPC\_Z\_VEL\_MAX\_DN 最大垂直下降速度。 默认：1 m/s。

MPC\_LAND\_ALT1 触发第一阶段降速的高度。 低于此高度，下降速度限制在 MPC\_Z\_VEL\_MAX\_DN (或MPC\_Z\_V\_AUTO\_DN) 和 MPC\_LAND\_SPEED（需大于MPC\_LAND\_ALT2）之间. 默认10米

MPC\_LAND\_ALT2 触发第二阶段降速的高度。 低于此高度，下降速度限制在MPC\_LAND\_SPEED （需小于MPC\_LAND\_ALT1） 默认 5 米。

RCX\_DZ 通道 X 的遥控死区。油门的 X 值取决于 RC\_MAP\_THROTTLE 的值。 例如，如果油门是通道4，则RC4\_DZ 指定死区。

MPC\_XXXX 大多数MPC\_xxx参数会影响此模式下的飞行行为（至少在某种程度上）。 例如，MPC\_THR\_HOVER 定义飞机悬停时的推力。

MPC\_POS\_MODE 从摇杆输入到机体动作的转换策略。 从 PX4 v1.12 开始，默认值 (4) 是操纵杆位置控制加速度（类似于汽车油门踏板）。 其他选项允许操纵杆偏转直接控制地面速度，有或没有平滑和加速度限制。

MPC\_ACC\_HOR\_MAX 最大水平加速度。

MPC\_VEL\_MANUAL 最大水平速度。

MPC\_LAND\_SPEED 着陆下降率. 默认 0.7 m/s.

## **位置丢失/安全**

位置模式依赖于一个可接受的位置估计。 如果估计值低于可接受的水平，例如由于 GPS 丢失，这可能会触发位置 (GPS) 丢失故障保护 根据配置，是否有遥控器，以及是否有足够的高度估计，PX4 可能会切换到高度模式、手动模式、降落模式或终止。

## **定高模式（多旋翼）**

\[飞行难度：简单\] \[需要手动/遥控器控制\] \[需要高度传感器（例如气压计、测距仪）\]

高度模式是一种相对容易飞行的RC模式，其中滚动和俯仰杆控制车辆在左右和前后方向（相对于车辆的“前部”）上的运动，偏航杆控制水平面上的旋转速度，油门控制升降速度。

当操纵杆松开/居中时，车辆将保持水平并保持当前高度. 如果在水平面上运动，机体将继持续运动直到任何动量被风阻力消散。 如果刮风，飞机会向风的方向漂移。

提示

高度模式是新飞行员最安全的非GPS手动模式. 就像手动/自稳模式，但是在松开摇杆时也可以锁定机体高度。

下图直观的展示了该模式（以美国手的遥控器举例）。

![read-normal-img](https://i0.hdslb.com/bfs/article/c8136fc117b487f57d0b02bd8391036d479817593.png@progressive.webp)

多旋翼高度控制 -美国手遥控器

## **技术总结**

与手动/自稳模式类似，但具有高度稳定（居中操纵杆使车辆保持水平并保持在固定高度）。

回正摇杆（内带死区）：

RPY摇杆使飞机水平。

油门（~50%）抗风保持当前姿态。

外部中心：

翻滚/俯仰摇杆控制各自方向的倾斜角，导致左右和前后的移动。

油门摇杆以预定的最大速率（和其他轴上的移动速度）控制上升速度。

偏航摇杆控制水平面上方的角度旋转速率。

起飞：

如果将油门杆抬高至 62.5%（从油门杆最低开始的整个范围），无人机将起飞。

注解

需要手动输入（遥控器，或者通过 MAVLink 连接的游戏手柄/拇指摇杆）。

通常使用气压计测量高度，在极端天气条件下可能会变的不准确。 带有激光雷达/距离传感器的飞机将能够以更高的可靠性和准确性控制高度。

## **参数**

该模式受以下参数影响：

MPC\_Z\_VEL\_MAX\_UP 最大垂直上升速度。 默认：3m/s。

MPC\_Z\_VEL\_MAX\_DN 最大垂直下降速度。 默认：1m/s。

RCX\_DZ 通道 X 的遥控死区。油门的 X 值取决于 RC\_MAP\_THROTTLE 的值。 例如，如果油门是通道4，则 RC4\_DZ 指定死区。

MPC\_XXXX 大多数 MPC\_xxx参数会影响此模式下的飞行行为（至少在某种程度上）。 例如，MPC\_THR\_HOVER定义飞机悬停时的推力。

## **手动/自稳模式（多旋翼）**

\[飞行难度：中等\] \[需要手动/遥控器控制\]

当RC控制杆居中时，手动/稳定模式可稳定多旋翼。要手动使机体移动/飞，您可以移动摇杆使其偏离居中位置。

注解

在手动/自稳控制下，侧倾杆和俯仰杆控制车辆绕各自轴的角度（姿态），偏航杆控制水平面上方的旋转速度，油门控制高度/速度。

一旦释放摇杆，它们将会返回中心死区。 一旦横滚和俯仰摇杆居中，多旋翼无人机将平稳并停止运动。 然后机体将悬停在适当的位置/保持高度 - 前提是平衡得当，油门设置适当，并且没有施加任何外力（例如风）。 飞行器将朝着任何风的方向漂移，您必须控制油门以保持高度。

![read-normal-img](https://i0.hdslb.com/bfs/article/3895e1efcb86321896976043bba508f4479817593.png@progressive.webp)

## **技术描述**

飞手的输入通过横滚和俯仰角度以及偏航角速率指令传递给自驾仪。 自动驾驶仪控制着姿态，这意味着当遥控器摇杆居中时，它调整飞机的横滚和俯仰角为零（因此使姿态变平）。 自动驾驶仪不能补偿由于风（或其他来源）引起的漂移。

## **参数**

MPC\_THR\_HOVER 当油门杆居中输出的悬停油门，默认值为MPC\_THR\_CURVE。

MPC\_THR\_CURVE 定义油门缩放比例。 默认情况下，这被设置为重新缩放悬停推力，这意味着当油门杆居中时，油门输出为悬停油门（MPC\_THR\_hover），并且杆输入被线性地重新缩放到低于和高于该值（允许自稳和高度/位置控制之间的平滑过渡）。

在动力很强的机体上，悬停油门可能非常低（例如低于 20％），因此重新调整会使油门输入变形 - 对应上面举例， 80％ 的推力将仅由摇杆输入的中位以上部分控制，20％ 的推力由中位以下的部分来控制。 如果需要，可以将MPC\_THR\_CURVE设置为No Rescale（无重缩放），以便不进行重缩放

## **特技模式（多旋翼）**

\[飞行难度：困难\] \[需要手动/遥控器控制\]

特技模式是用于执行特技动作的RC模式，例如翻转、翻滚。

横滚、俯仰和偏航杆控制围绕各自轴的角速率，油门直接传递至控制分配。 当操纵杆居中时，飞机将停止旋转，但保持其当前姿态并根据当前动量移动。

## **技术描述**

用于执行特技动作的R遥控/手动模式，例如翻转，滚转和环绕。

RPY摇杆输入控制围绕各自轴的角度旋转速率。 当操纵杆居中时，飞机将停止旋转，但保持其当前朝向（不一定是水平）。

![read-normal-img](https://i0.hdslb.com/bfs/article/8eae37706bc4aaad8c50404553ceda48479817593.png@progressive.webp)

## **摇杆输入映射**

特技模式下默认的滚转、俯仰和偏航操纵杆输入映射如下所示。 该曲线使得在最大杆输入处具有大转弯速率能够进行特技动作，在靠近杆回中位置的区域具有较低灵敏度以进行微调。

![read-normal-img](https://i0.hdslb.com/bfs/article/99f7a30d9b62c39b67fa24a000963e6e479817593.png@progressive.webp)

可以使用MC\_ACRO\_EXPO和MC\_ACRO\_SUPEXPO参数调整滚转和俯仰轴杆输入响应，同时使用MC\_ACRO\_EXPO\_Y和MC\_ACRO\_SUPEXPOY调整偏航轴杆输入响应 。 MC\_ACRO\_EXPO和MC\_ACRO\_EXPO\_Y参数用于调整线性曲线和三次曲线之间的曲线，如下所示。 MC\_ACRO\_SUPEXPO和MC\_ACRO\_SUPEXPOY允许进一步调整曲线形状，修改低灵敏度区域的宽度。

![read-normal-img](https://i0.hdslb.com/bfs/article/8c2953177b5b2418e1556c93ed2510e7479817593.png@progressive.webp)

数学关系是：

其中y是纵轴，x是横轴，f = MC\_ACRO\_EXPO 或 MC\_ACRO\_EXPO\_Y，g = MC\_ACRO\_SUPEXPO 或 MC\_ACRO\_SUPEXPOY ， r 为最大速率。

您可以在<u>此处</u>进行试验。

## **参数**

MC\_ACRO\_EXPO 特技模式“指数”因子，用于调整滚转和俯仰轴的杆输入曲线形状。 值：0表示纯线性输入曲线，1表示纯三次输入曲线。 默认：0.69

MC\_ACRO\_EXPO\_Y 特技模式“指数”因子，用于调整偏航轴的杆输入曲线形状。 值：0表示纯线性输入曲线，1表示纯三次输入曲线。 默认：0.69

MC\_ACRO\_SUPEXPO 特技模式“超级指数”因子，用于精细调整滚动轴和俯仰轴的杆输入曲线形状（使用MC\_ACRO\_EXPO进行调整）。 值：0——纯指数函数，0.7——合理增强直观操纵感的形状，0.95——非常弯曲的输入曲线，仅在最大值附近有效。 默认：0.7

MC\_ACRO\_SUPEXPOY 特技模式“超级指数”因子用于精细调整偏航轴的杆输入曲线形状（使用MC\_ACRO\_EXPO\_Y进行调整）。 值：0——纯指数函数，0.7——合理增强直观操纵感的形状，0.95——非常弯曲的输入曲线，仅在最大值附近有效。 默认：0.7

MC\_ACRO\_P\_MAX 最大特技俯仰速率 默认：每秒2转（720度/秒）

MC\_ACRO\_R\_MAX 最大特技滚转速率 默认：每秒2转（720度/秒）

MC\_ACRO\_Y\_MAX 最大特技偏航速率 默认： 1.5转每秒（540度/秒）

![read-normal-img](https://i0.hdslb.com/bfs/article/48af52c0aa318994b8b866142aee84b0479817593.png@progressive.webp)

![read-normal-img](https://i0.hdslb.com/bfs/article/b85ce765484bf364994a27a3bf2d2113479817593.png@progressive.webp)

注解

该模式下遥控器是可选的，如果没有遥控，则环绕模式如上所述。 无法使用遥控来切换该模式（如果使用遥控切换该模式，无人机会处于空闲状态）。

遥控可以用于改变绕圈的高度，半径，速度和绕圈方向：

左摇杆：

上/下：控制上升/下降速度，如位置模式。当在中部死区时，高度被锁定。

左/右：无影响。

右摇杆：

左/右：控制顺时针/逆时针方向的轨道加速度。当居中时，当前速度被锁定。

最大速度为 10 m/s，进一步的限制是将向心加速度保持在 2 m/s^2 以下。

上/下：控制轨道半径（更小/更大）。当居中时，当前半径被锁定。

最小半径是 1 米。 最大半径是 100 米。

下图直观的显示了模式行为（对于一个美国手遥控器）。

![read-normal-img](https://i0.hdslb.com/bfs/article/6f974263695187f801b34257dd2c2864479817593.png@progressive.webp)

## **参数/限制**

没有特定的环绕模式参数。

下面的限制是写死的：

初始/默认是顺时针方向 1 m/s 旋转。

最大加速度限制在 2 m/s^2。

优先保持控制的圆周轨迹而不是地速（即， 如果加速度超过 2 m/s^2无人机将减速以达到正确的圆周）。

最大半径是 100 米。

环绕模式可以使用以下 MAVLink 命令：

MAV\_CMD\_DO\_ORBIT：启动一个指定中心点，半径，方向，高度，速度和偏航方向的轨道（无人机默认朝向轨道中心）。

ORBIT\_EXECUTION\_STATUS ：在环绕模式发出的环绕状态。

## **定点模式（固定翼）**

\[易于使用\] \[需要手动或遥控控制\] \[需要定位修复（例如GPS）\]

位置模式是一种易于飞行的RC模式，在该模式下，当杆释放/居中时，飞机将水平并沿当前方向直线飞行，以补偿风和其他力。

油门取决于空速（在 50％ 油门时，飞机将以预设的巡航速度保持其当前高度）。 俯仰用于爬升或下降。 翻滚、俯仰和偏航是角度控制的（因此不可能实现飞机滚转或环绕）。

提示

位置模式对于新手是最安全的固定翼手动模式。

下图直观的显示了该模式（对于一个美国手的发射机）。

![read-normal-img](https://i0.hdslb.com/bfs/article/f3f9c175c6fde940f11397faf60d6996479817593.png@progressive.webp)

## **定高模式（固定翼）**

\[易于飞行\] \[需要手动或遥控控制\] \[所需高度（例如巴罗、测距仪）\]

高度飞行模式使用户更容易控制车辆高度，尤其是达到和保持固定高度。该模式不会试图抵抗风扰保持航向。

爬升/下沉率通过俯仰/升降舵杆操纵杆来控制。 操纵杆一旦回中，自动驾驶仪就会锁定当前的高度，并在偏航/滚转和任何空速条件下保持高度。

油门通道输入控制空速。 滚动和俯仰是角度控制的（因此不可能实现飞机滚转或环绕）。

当所有遥控输入都居中时（无滚动、俯仰、偏航，油门约 50％），飞机将恢复直线水平飞行（受风影响）并保持其当前高度。

下图直观的显示了该模式（对于一个美国手的发射机）。

![read-normal-img](https://i0.hdslb.com/bfs/article/3c87bf21cf1b2c3effed51eed5a7a513479817593.png@progressive.webp)

## **技术总结**

遥控/手动模式，如自稳模式，但具有高度稳定性（杆回中使飞机进入直线和水平飞行并保持当前高度）。 但是飞行过程并不稳定，可能被风吹飘离。

回中的滚动/俯仰/偏航输入（在死区内）：

自动驾驶仪使飞机/机翼水平并且维持高度。

如果空速传感器已连接，油门杆控制飞机速度。 在没有空速传感器的情况下，用户无法控制油门（在这种情况下，飞机将在巡航油门下(FW\_THR\_CRUISE) 水平飞行，根据需要增加或减少油门以上升或下降。

外部中心：

俯仰摇杆控制高度。

油门杆控制飞机的空速（如回中输入 横滚/俯仰/偏航）。

横滚摇杆控制横滚角度。 自动驾驶仪将保持 协调飞行。 这和自稳模式一样。

偏航摇杆操纵会驱动方向舵（指令将被加到自动驾驶仪计算的指令中以维持 协调飞行。 这和自稳模式一样。

注解

需要手动输入（遥控器，或者通过 MAVLink 连接的游戏手柄/拇指摇杆）。

通常使用气压计测量高度，在极端天气条件下可能会变的不准确。 带有激光雷达/距离传感器的飞机将能够以更高的可靠性和准确性控制高度。

## **参数**

该模式受以下参数影响：

FW\_MAN\_P\_MAX 在高度稳定模式下手动控制的最大俯仰角。 默认：45 度。

FW\_MAN\_R\_MAX 在高度稳定模式下手动控制的最大滚转角。 默认：45 度。

## **自稳模式（固定翼）**

\[中等飞行难度\] \[需要手动或遥控控制\]

当RC杆居中时，稳定模式使车辆进入直线和水平飞行，保持水平姿态迎风（但不包括车辆航向和高度）。

如果横滚/俯仰摇杆杆不为零，则无人机根据俯仰输入进行爬升/下降并执行协调的转弯。 横滚和俯仰是角度控制的（不能上下滚动或翻滚）。

提示

稳定模式比手动模式更容易飞行，因为你不能翻滚或翻转它，而且通过对中控制杆很容易调平车辆。

如果油门降至 0％（电机停止），飞机将滑行。 为了执行转弯，必须在整个操纵过程中保持命令，因为如果释放横滚摇杆，则飞机将停止转动并自行调平（对于俯仰和偏航命令也是如此）。

下图直观的显示了该模式（对于一个美国手发射机）

![read-normal-img](https://i0.hdslb.com/bfs/article/9b47b40974a1bb34ff81dbd561b80050479817593.png@progressive.webp)

## **技术描述**

遥控/手动模式，横滚和俯仰摇杆回中使飞机改平。

摇杆回中会使飞机进入定直平飞。 但是飞行航向和高度并不稳定，可能被风吹飘离。

如果滚转/俯仰杆输入非零，则飞机进行协调转弯（手动偏航输入被添加到方向舵控制输入以控制侧滑）。

## **特技模式（固定翼）**

\[很难飞\] \[需要手动或遥控控制\]

杂技模式是用于执行杂技动作的RC模式，例如翻滚、翻转、失速和杂技动作。

侧倾、俯仰和偏航杆控制围绕各自轴的角旋转速率，油门直接传递至控制分配。当操纵杆居中时，飞机将停止旋转，但保持其当前朝向（在其侧面，倒置或任何其他方向）并根据当前动量移动。

![read-normal-img](https://i0.hdslb.com/bfs/article/dd218d6da55758756154219f31575035479817593.png@progressive.webp)

## **技术描述**

用于执行特技动作的遥控模式，例如滚动、翻转。

RPY摇杆输入被转换为角速度命令，通过自动驾驶仪稳定。 油门直接传递到电机输出。

## **参数**

FW\_ACRO\_X\_MAX 机体轴x轴最大速率（用户在acro模式下施加滚转轴满杆操纵时，控制器试图达到的机体轴x轴速率） 默认：90度

FW\_ACRO\_Y\_MAX 机体轴y轴最大速率（用户在acro模式下施加俯仰轴满杆操纵时，控制器试图达到的机体轴y轴速率） 默认：90度

FW\_ACRO\_Z\_MAX 机体轴z轴最大速率（用户在acro模式下施加偏航轴满杆操纵时，控制器试图达到的机体轴z轴速率） 默认：45度

## **手动模式（固定翼）**

\[很难飞\] \[需要手动或遥控控制\]

手动模式将摇杆输入直接发送至控制分配，以实现完全手动控制。

提示

这是最难飞行的模式，因为什么都不稳定。 不同于特技模式，如果 RP （俯仰和横滚） 摇杆居中，无人机不会自动停止绕轴转；飞手实际上必须移动摇杆向另一个方向施力。

注解

这是唯一忽略 FMU（命令通过安全协处理器发送） 的飞行模式。 该模式提供了一个安全机制，允许在 FMU 固件故障时通过遥控器完全控制油门，升降舵，副翼和方向舵。

## **技术描述**

遥控模式，其中摇杆输入直接发送到混控（用于“完全”手动控制）。

这是唯一忽略主处理器（命令通过安全协处理器发送） 的飞行模式。 该模式提供了一个安全机制，允许在 FMU 固件故障时通过遥控器完全控制油门，升降舵，副翼和方向舵。

## **参数**

FW\_MAN\_P\_SC 手动俯仰控制比例。 在完全手动模式下应用于所需俯仰舵机指令的比例因子。 此参数允许调整控制舵偏的偏转。 默认：1.0

FW\_MAN\_R\_SC 手动滚转控制比例。 在完全手动模式下应用于所需横滚舵机指令的比例因子。 此参数允许调整控制舵偏的偏转。 默认：1.0

FW\_MAN\_Y\_SC 手动偏航控制比例。 在完全手动模式下应用于所需偏航舵机指令的比例因子。 此参数允许调整控制舵偏的偏转。 默认：1.0

## **起飞模式**

\[需要定位（例如 GPS ）\]

起飞飞行模式使无人机起飞到指定高度并等待进一步指令。

注解

该模式需要一个良好的位置估计（如，从 GPS 中获取）。

使用此模式前必须先解锁。

This mode is automatic - no user intervention is required to control the vehicle.

遥控开关可以在任何无人机上更改飞行模式。

在多旋翼中移动遥控器摇杆（或 VTOL 在多旋翼模式下）默认情况下会将无人机切换到位置模式，除非是处理电池失效保护。

如果起飞时出现问题， 故障检测器 将自动停止电机。

下面描述每种类型飞机的具体行为。

## **多旋翼（MC）**

多旋翼上升到 MIS\_TAKEOFF\_ALT 中定义的高度并保持位置。

遥控器摇杆移动会把无人机切换到 位置模式 （默认）。

起飞受以下参数影响：

MIS\_TAKEOFF\_ALT 起飞期间的目标高度 (默认值: 2.5 米)

MPC\_TKO\_SPEED 上升速度 (默认值: 1.5 m/s)

COM\_RC\_OVERRIDE 控制多旋翼（或者多旋翼模式下的 VOTL）的摇杆移动量来切换到 位置模式。 可以分别为自动模式和 offboard 模式启用此功能，默认情况下在自动模式下启用此功能。

COM\_RC\_STICK\_OV 导致发射机切换到 位置模式 的摇杆移动量（如果 COM\_RC\_OVERRIDE 已启用）。

## **固定翼（FW）**

飞机使用弹射器/手抛起飞模式或跑道起飞模式沿当前方向起飞。模式默认为弹射/手动起飞，但可以使用 RWTO\_TKOFF 设置为跑道起飞。 在这两种情况下，遥控操作都被忽略。

**弹射/手抛起飞**

在弹射器/手抛起飞模式下，车辆等待检测起飞（基于加速触发）。在起飞时，它在大约2秒内升到全油门（RWTO\_MAX\_THR），然后执行全油门爬升，最小起飞俯仰10度。

一旦它达到 FW\_CLMBOUT\_DIFF 它将过渡到 保持模式 和悬停。

除了上面讨论的行为之外，还有一个启动检测器可以阻止启动程序开始直到满足某些条件。 对于弹射器发射，这是一些加速度阈值。

**跑到起飞**

跑道起飞模式有以下阶段：

加速滑行：在跑道上加速（俯仰固定，无侧倾，航向保持），直到达到起飞的最小空速（FW\_AIRSPD\_MIN x RWTO\_AIRSPD\_SCL）。

起飞：增加俯仰并继续，直到车辆高度>导航高度（RWTO\_NAV\_ALT）。

爬升：爬升至高于地面高度>FW\_CLMBOUT\_DIFF。在此阶段中, 将移除滚转和航向限制。

**固定翼起飞参数**

起飞受以下参数影响：高于地平面（AGL）的高度，留有足够的离地间隙以允许一些滚转。 在达到RWTO\_NAV\_ALT之前，飞机保持水平，并且仅使用方向舵来保持航向（参见RWTO\_HDG ）。

起飞时，无人机 总是遵循正常的固定翼最大/最小油门设置（FW\_THR\_MIN，FW\_THR\_MAX）。

垂直起降（VTOL）

VTOL 在启动时默认为多旋翼模式，通常可以在多旋翼模式下起飞（而且也更安全）。

也就是说，如果在起飞前切换到固定翼，将以固定翼模式起飞。

## **着陆模式**

\[需要定位估计（例如GPS）\]

使无人机降落在开启此模式时的位置。降落后，无人机将会在一小段时间后上锁（默认情况下）。

注解

该模式需要有效的位置估计，除非由于失效保护进入该模式，这种情况下仅需要高度估计（通常飞控内置一个气压计）。

此模式为自动模式-无需用户干预即可控制飞机。

遥控器开关可以用于更改任何无人机的飞行模式。

在多旋翼中移动遥控器摇杆（或 VTOL 在多旋翼模式下）默认情况下会将无人机切换到位置模式，除非是处理电池失效保护。

下面描述每种类型飞机的具体行为。

## **多旋翼（MC）**

无人机将降落在模式所指定的位置。 无人机以 MPC\_LAND\_SPEED 指定的速度下降，降落后会上锁（默认）。

遥控器摇杆移动会把无人机切换到 位置模式 （默认）。

着陆受以下参数影响：

MPC LAND\_SPEED 着陆过程中的下降速率。 鉴于地面情况未知，这个值应该设得相当小。

COM\_DISARM\_LAND 降落后自动上锁的超时时间，以秒为单位。 如果设定为 -1，无人机将不会在着陆时上锁。

COM\_RC\_OVERRIDE 控制多旋翼（或者多旋翼模式下的 VOTL）的摇杆移动是否将控制权交给位置模式下的飞手。 可以分别为自动模式和 offboard 模式启用此功能，默认情况下在自动模式下启用此功能。

COM\_RC\_STICK\_OV 导致发射机切换到 位置模式 的摇杆移动量（如果 COM\_RC\_OVERRIDE 已启用）。

## **固定翼（FW）**

无人机将转弯并降落在该模式指定的位置。 遥控器摇杆操作被忽略。

通常固定翼无人机会遵循固定的着陆轨迹到地面（它不会尝试拉平着陆）。 这是因为在着陆模式下，飞机可能不知道地面高度并且将假设它处于海平面。 由于地面高度可能会高得多，因此飞机通常会在高于拉平辑逻辑的高度处到达地面。

着陆受以下参数影响

COM\_DISARM\_LAND 降落后自动上锁的超时时间，以秒为单位。 如果设定为 -1，无人机将不会在着陆时上锁。

垂直起降（VTOL）

当处于固定翼模式时，VTOL 遵循 LAND 行为和固定翼的参数，而当处于多旋翼模式时，VTOL 遵循多旋翼的参数。 当设置 NAV\_FORCE\_VT（默认：开）时，固定翼模式下的 VTOL 将在着陆前切换回多旋翼模式。

## **返航模式**

\[需要定位（例如 GPS ）\]

返航飞行模式用于将车辆在无障碍的路径上安全飞行至安全目的地，在那里可以等待（悬停或盘旋）或降落。

PX4 提供了几种机制来选择安全的返航路径，以下章节解释了如何配置 返航类型， 返航高度 和 降落/抵达行为。 最后有章节解释了每种机型的默认（预配置）行为。

注解

该模式需要 GPS。

遥控开关可以在任何无人机上更改飞行模式。

在多旋翼中移动遥控器摇杆（或 VTOL 在多旋翼模式下）默认情况下会将无人机切换到位置模式，除非是处理电池失效保护。

## **返航类型（RTL\_TYPE）**

PX4 提供了四种替代方法（ RTL\_TYPE ），用于找到通向安全目的地和/或着陆的畅通路径：

返航到起始位置/集结点（RTL\_TYPE=0）: 上升到安全高度并直接路径返回到最近的集结点或起始地点。

任务着陆/集结点返回（RTL\_TYPE=1）：上升到安全高度，直接飞到离家最近的目的地：集结点或任务着陆开始。 如果未定义任务着陆点或集结点，则直接返回起始位置。

任务路径返航（RTL\_TYPE=2）：使用任务模式的路径并沿原路径返回。 如果未定义任务降落，则将快速回退到任务起始位置。 如果未定义任务，直接返航到起始位置（集结点将被忽略）。

最近的安全目的地返航（RTL\_TYPE = 3）：上升到安全高度并通过直接路径返回最近的起始位置，任务着陆点的开始位置或集结点。

以下各节提供了每种类型的更详细说明。

## **起始位置/集结点返航类型（RTL\_TYPE=0）**

无人机在该返航类型中：

爬升到一个安全的返航高度（高于任何可预期的障碍物）。

通过直接路径飞往起始位置或集结点（以最近者为准）。

降落或等待处于下降高度（取决于着陆参数）。

注解

如果未定义集结点，这与返回起飞点（RTL）/返回原点（RTH）相同。

## **任务着陆/集结点返航类型 (RTL\_TYPE=1)**

无人机在该返航类型中：

爬升到一个安全的返航高度（高于任何可预期的障碍物）。

直接飞行到一个集结点或任务着陆模式的起点（以最近者为准）。 如果未定义任务降落或集结点，无人机通过直接路径返回到起始位置。

如果目的地是飞行任务着陆模式，则按照该模式降落。

如果目的地是集结点或者起始位置，无人机将在降落高度（取决于着陆参数）降落或等待。

## **保持模式**

\[需要定位（例如 GPS）\]

等待飞行模式（也称为“悬停”）使车辆停止并保持其当前的GPS位置和高度（MC车辆将在GPS位置悬停，而FW车辆将在其周围盘旋）。

提示

保持模式可用于暂停任务或帮助您在紧急情况下重新控制车辆。它通常通过预编程开关激活。

注解

该模式需要 GPS。

此模式为自动模式-无需用户干预即可控制车辆。

遥控开关可以在任何无人机上更改飞行模式。

在多旋翼中移动遥控器摇杆（或 VTOL 在多旋翼模式下）默认情况下会将无人机切换到位置模式，除非是处理电池失效保护。

下面描述每种类型飞机的具体行为。

## **多旋翼（MC）**

多旋翼无人机悬停在当前位置和高度。

遥控器摇杆移动会将无人机切换到 位置模式 （默认）。

可以使用以下参数配置此动作。

MIS\_LTRMIN\_ALT 留待模式的最小高度（如果模式在较低的高度进行，则飞行器将上升到此高度）。

COM\_RC\_OVERRIDE 控制多旋翼（或者多旋翼模式下的 VOTL）的摇杆移动量来切换到 位置模式。 可以分别为自动模式和 offboard 模式启用此功能，默认情况下在自动模式下启用此功能。

COM\_RC\_STICK\_OV 导致发射机切换到 位置模式 的摇杆移动量（如果 COM\_RC\_OVERRIDE 已启用）。

## **固定翼（FW）**

飞机在当前高度并在 GPS 保持的位置绕圈飞行。 如果在低于这个高度使用该模式，无人机会首先上升MIS\_LTRMIN\_ALT。

遥控器摇杆操作被忽略。

可以使用以下参数配置此动作。

NAV\_LOITER\_RAD 留待圈的半径。

MIS\_LTRMIN\_ALT 留待模式的最小高度（如果模式在较低的高度进行，则飞行器将上升到此高度）。

## **垂直起降（VTOL）**

当处于固定翼模式时，VTOL 遵循固定翼的参数，而当处于多旋翼模式时，VTOL 遵循多旋翼的参数。

## **任务模式**

\[需要定位（例如 GPS）\]

任务模式使车辆执行已上传至飞行控制器的预定义自主任务（飞行计划）。任务通常由地面控制站（GCS）应用程序（如QGroundControl）创建并上传

注解

此模式需要 3d 位置信息（如 GPS）。

使用此模式前必须先解锁。

遥控器开关可以用于更改任何无人机的飞行模式。

在多旋翼中移动遥控器摇杆（或 VTOL 在多旋翼模式下）默认情况下会将无人机切换到位置模式，除非是处理电池失效保护。

## **参数描述**

任务通常在地面控制站规划，并在启动前上传。它们也可以由开发者API创建，和/或在飞行中上传。个别任务指令的处理方式取决于每种飞行器的飞行特性（例如，直升机的悬停飞行和固定翼的盘旋飞行）。 VTOL飞机在固定翼模式下遵循固定翼的行为和参数，在多旋翼模式下遵循旋翼机的行为和参数。

注解

任务上传到SD卡上，需要在启动自动驾驶仪之前插入SD卡。

在高级别上，所有无人机类型在使用 MISSION 模式时表现相同：

如果任务被开始并且无人机正在飞行，则它将从当前步骤执行 任务/飞行计划。

如果开始了任务, 并且无人机在地面:

多旋翼无人机将执行任务/飞行计划. 如果任务没有 TAKEOFF 命令，则在从当前步骤执行飞行计划的剩余部分之前，无人机将飞行到最小高度。

在固定翼飞行器上，无人机不会自动起飞（自动驾驶仪将检测运动并将油门设置为零）。 如果在任务模式下手动或弹射发射，飞机可以开始执行任务。

如果停止任务，或者无人机已完成所有任务并且无人机正在飞行，飞机将会留待。

可以通过激活HOLD 模式暂停任务。 当您重新激活 MISSION 飞行模式时，任务将从当前任务命令继续执行。 在任务模式下飞行时，如果决定中止任务，并且切换到了其他飞行模式，如位置模式，通过遥控器讲无人机飞到了其他地方，然后切换回任务模式，无人机将从当前位置继续执行任务，并会飞往下一个未访问的任务航点。

注意

在切换到其他遥控器模式之前，确保油门摇杆不为零（否则无人机将坠毁）。 我们建议您在切换到任何其他模式之前将摇杆置中。

有关任务规划的更多信息，请参阅：

任务参数

任务行为受许多参数的影响. 下面列出了一个很小的子集。

NAV\_RCL\_ACT 遥控信号丢失失效保护模式（如果断开遥控无人机会怎样）- 例如进入保持模式，返航模式，终止等。

NAV\_LOITER\_RAD 固定翼悬停半径。

COM\_RC\_OVERRIDE 控制多旋翼（或者多旋翼模式下的 VOTL）的摇杆移动是否将控制权交给位置模式下的飞手。 可以分别为自动模式和 offboard 模式启用此功能，默认情况下在自动模式下启用此功能。

COM\_RC\_STICK\_OV 导致发射机切换到 位置模式 的摇杆移动量（如果 COM\_RC\_OVERRIDE 已启用）。

注意：

对于任务命令，PX4 不支持本地坐标系（例如，MAV\_FRAME\_LOCAL\_NED）

## **跟随模式**

\[需要定位（例如GPS）\]

跟随模式允许多旋翼机自主保持相对于另一个系统的位置和高度，该系统使用Follow\_TARGET广播其位置（可选速度）MAVLink消息。

跟随的概念

根据高度控制模式，车辆将从指定的相对角度、距离、高度和高度自动偏转到目标面并跟随目标。

默认情况下，它将直接从目标后面跟随，距离为8米，高度为起始（待命）位置上方8米。

![read-normal-img](https://i0.hdslb.com/bfs/article/f589ecd8083a3c4dad917a47fc1496d4479817593.png@progressive.webp)

用户可以使用如上所示的遥控器调整跟随角度、高度和距离：

跟随高度由上下输入（“油门”）控制。将棍子居中，以恒定的高度跟踪目标。升高或降低摇杆以调整高度。

跟随距离由前后输入（“俯仰”）控制。向前推操纵杆会增加跟随距离，向后拉则会减少距离。

跟随角度由左右输入（“滚动”）控制。移动是从用户的角度出发的，所以如果你面对无人机并向左移动棍子，它就会向你的左边移动。从上方看，如果向左移动操纵杆，无人机将逆时针移动。

跟随角度定义为相对于目标航向（0度）沿顺时针方向增加

![read-normal-img](https://i0.hdslb.com/bfs/article/e95eb54fb1fd728e039fffa4520c6ad5479817593.png@progressive.webp)

跟随角度图

注解

退出跟随模式时，将放弃使用RC控制器设置的角度、高度和距离值。如果退出跟随模式并再次激活，则值将重置为默认值。

在带有GPS模块和MAVSDK的Android设备上，QGroundControl支持跟随模式。

注解

此模式需要GPS。

此模式目前仅在多旋翼上受支持。

跟踪目标还必须能够提供位置信息。

QGroundControl仅在具有GPS的Android设备上支持此模式。

## **安全须知**

注意

跟车模式不实施任何类型的障碍物回避。使用此模式时必须特别小心。

应遵守以下飞行预防措施：

跟我走模式只能在没有树木、电线、房屋等遮挡的开阔区域使用。

将跟随高度设置为远高于任何周围障碍物的值。默认情况下，该位置高于原始（待命）位置8米。

在启用跟我模式之前手动飞到安全高度比在着陆时启用跟我方式更安全（即使该模式实现自动起飞）。

为无人机留出足够的制动空间，尤其是在无人机快速行驶时。

如果出现问题，准备切换回位置模式，特别是第一次使用跟随模式时。

您不能使用摇杆移动来关闭跟随我模式（因为这将调整属性）。您需要有一个可以发送飞行模式开关信号的地面站，或者在RC发射机中配置一个飞行模式开关。

## **通过QGroundControl使用跟随模式**

使用QGroundControl作为具有GPS模块的地面站硬件上的目标，支持跟随模式。推荐的配置是一个能使用 USB OTG 的安卓设备，配备两个数传。

![read-normal-img](https://i0.hdslb.com/bfs/article/b17cddfb5476d0a3e5cf4eea30345ed4479817593.png@progressive.webp)

设置跟随模式：

将遥测无线电连接到地面站设备，将另一个连接到车辆（这允许在两个无线电之间中继定位信息）。

禁用Android设备上的睡眠模式：

此设置通常可以在“设置”>“显示”下找到。

禁用Android设备上的睡眠模式很重要，因为这可能会导致GPS信号停止定期发射。

起飞高度至少为2-3米（即使支持自动起飞，也建议如此）。

将无人机放在地面上，按下安全开关并后退至少10米。

解锁车辆并起飞。

切换到跟随我模式。

根据距离传感器的存在，直升机将首先上升到离地面或家1米的最低安全高度。

在水平移动之前，它将一直上升到跟随高度3米以内，以避免潜在的碰撞。

飞机会一直调整航向以面对目标

此时，你可以开始移动，无人机将跟踪你。

## **通过MAVSDK使用跟随模式**

MAVSDK支持跟随模式，允许您创建一个无人机应用程序，该应用程序设置跟随的目标。

有关更多信息，请参见“跟随我”类

（打开新窗口）文档以及“跟随我”示例

（打开新窗口）。

**配置高度控制模式**

![read-normal-img](https://i0.hdslb.com/bfs/article/ea88ffa7ded02919888d9278f2ffcc8a479817593.png@progressive.webp)

高度控制模式确定车辆高度是否相对于原位置、地形高度或跟随目标报告的高度。

2D跟踪（默认高度模式）使无人机在相对于固定起始位置（起飞高度）的高度跟随。无人机到目标的相对距离将随着你的上升和下降而改变（在丘陵地形中小心使用）。

2D+地形使用来自距离传感器的信息，使无人机以相对于其下方地形的固定高度跟随。如果车辆没有距离传感器，跟踪将与2D跟踪相同。距离传感器并不总是准确的，在这种模式下飞行时，车辆可能会“跳跃”。请注意，该高度相对于车辆下方的地面，而不是跟随目标。无人机可能无法跟踪目标的高度变化！

3D跟踪模式使无人机在其GPS传感器提供的相对于跟踪目标的高度上跟踪。这会适应目标高度的变化，例如当你上山时。

注意

当使用QGC for Android时，在未检查FOLLOW\_TARGET.altitude 是AMSL高度的情况下,请勿将高度模式（FLW\_TGT\_ALT\_M）设置为3D跟踪.MAVLink跟踪目标消息定义期望相对于平均海平面（AMSL）的高度，而Android上的QGC正在发送相对于GPS椭球的高度。这可以相差200米！

由于内置的最低安全高度限制（1米），无人机可能不会坠毁，但它可能会飞得比预期高很多。如果无人机的高度与规定的高度相差很大，假设地面站的高度输出错误，请使用2D跟踪。

## **参数**

可以使用以下参数配置跟随我的行为：

FLW\_TGT\_HT跟随高度，单位为米。请注意，此高度相对于起始/待命位置（而非目标车辆）是固定的。默认和最小高度为8米（约26英尺）

FLW\_TGT\_DST水平（x，y）平面内的无人机/地面站间距，单位为米。最小允许间距为1米。默认距离为8米（约26英尺）。

FLW\_TGT\_FA相对于目标航向的跟随角度，单位为度。如果输入的值超出范围\[-180.0，+180.0\]，则会自动转换并应用（例如480.0将转换为120.0）

FLW\_TGT\_ALT\_M高度控制模式。

0=二维跟踪（高度固定）

1=2D跟踪+地形跟踪

2=目标GPS高度的3D跟踪警告：请勿与Android的QGC一起使用。

FLW\_TGT\_MAX\_VEL围绕目标的轨道运动的最大相对速度，单位为m/s。

10米/秒已被证明是最佳点。

FLW\_TGT\_RS过滤传入目标位置的动态过滤算法响应性。

0.0=对运动和位置、速度和加速度的噪声估计非常敏感。

1.0=非常稳定但没有响应的滤波器

## **提示和技巧**

将跟随距离设置为12米以上（“建议最小距离”为8米）。

目标和无人机的GPS传感器之间存在固有的位置偏差（3~5米），这使得无人机在接近实际目标的地方跟踪“幽灵目标”。当跟车距离很小时，这一点更为明显。我们建议将跟随距离设置得足够大，以使GPS偏差不显著。

使用RC调整高度、距离和角度，您可以获得一些创造性的相机镜头。

已知的问题

已知 SiK 915兆赫数传 会干扰某些安卓设备的 全球定位系统信号接收。 保持数传和安卓设备之间尽可能远的距离，避免使用跟随模式时受到干扰。

QGC for Android报告了错误的海拔高度（高于椭球面而非AMSL的海拔高度）。跟随高度可以偏离200米！

## **Offboard 模式**

\[需要定位修复（例如GPS）\]

飞机遵守 MAVLink 提供的位置，速度或姿态设定值。 设定值可以由机载计算机上运行的 MAVLink API（例如 MAVSDK

(opens new window) 或 MAVROS

(opens new window)）提供（通常通过串口或 wifi 连接）。

提示

并非所有设置点消息和车辆都支持MAVLink允许的所有坐标系和值。仔细阅读以下章节，确保只使用支持的值。还请注意，在进入模式之前以及模式运行期间，必须以>2Hz的频率流发布定值。

注解

此模式需要位置或位/姿信息 - 例如 GPS、光流、视觉惯性里程计、mocap 等。

除了更改模式外， 禁止遥控器控制。

使用此模式前必须**先解锁**。

在启用此模式之前，车辆必须**已经接收到目标设定点**流（>2Hz）。

如果未以>2Hz的速率接收到目标设定值，则无人机将退出模式。

不支持MAVLink允许的所有坐标系和字段值。：：

## **描述**

Offboard 模式主要用于控制飞机运动和姿态，目前仅支持 MAVLink 消息的一个有限子集（未来将支持更多）。

其他操作, 如起飞、降落、返航，最好使用适当的模式来处理。 像上传、下载任务这样的操作可以在任何模式下执行。

在进入该模式之前，无人机必须收到设定值数据流，并且保持在该模式下（如果消息速率降至 2Hz 以下，无人机将停止）。 为了在此模式下保持位置，必须向无人机提供一个包含当前位置设定值的数据流。

Offboard 模式需要主动连接到远程 MAVLink 系统 （例如机载计算机或 GCS）。 如果连接丢失，在超时 (COM\_OF\_LOSS\_T) 后，无人机将尝试降落或执行其他故障失效保护操作。 该动作定义在参数 COM\_OBL\_ACT 和 COM\_OBL\_RC\_ACT 中。

## **支持的消息**

## **多旋翼/垂直起降**

SET\_POSITION\_TARGET\_LOCAL\_NED

支持以下输入组合：

位置设置值 （仅 x，y，z）

速度设置值 (仅 vx, vy, vz)

加速度设定值（仅 afx，afy，afz）

PX4支持以下coordinate\_frame值

MAV\_FRAME\_LOCAL\_NED

MAV\_FRAME\_BODY\_NED

SET\_POSITION\_TARGET\_GLOBAL\_INT

支持以下输入组合：

位置设定值（仅lat\_int，lon\_int，alt）

Velocity setpoint (only vx, vy, vz)

Thrust setpoint (only afx, afy, afz)

注解

PX4 支持以下 coordinate\_frame 值(仅限)：

MAV\_FRAME\_GLOBAL

SET\_ATTITUDE\_TARGET

支持以下输入组合：

带有推力设定值（SET\_ATTITUDE\_TARGET.thrust）的姿态和方向（SET\_ATTITUDE\_TARGET.q）。

带有推力设定值（SET\_ATTITUDE\_TARGET.thrust）的机身速率（SET\_ATTITUDE\_TARGET .body\_roll\_rate，.body\_pitch\_rate，.body\_yaw\_rate）。

## **Offboard参数**

COM\_OF\_LOSS\_T 丢失 Offboard 连接时的等待超时时间（以秒为单位），然后将触发 offboard 丢失的失效保护措施 (COM\_OBL\_ACT 和 COM\_OBL\_RC\_ACT)

COM\_OBL\_ACT 当未连接到RC时，如果失去offboard控制，则切换到的模式（值为-0:着陆，1:保持，2:返回）。

COM\_OBL\_RC\_ACT 当仍连接到RC控制时，如果失去offboard控制，则切换到的模式（值为-0：位置，1：高度，2：手动，3：返回，4：降落）。

COM\_RC\_OVERRIDE 控制多旋翼（或者多旋翼模式下的 VOTL）的摇杆移动量来切换到 位置模式。 默认情况下未启用此功能。

COM\_RC\_STICK\_OV 导致发射机切换到 位置模式 的摇杆移动量（如果 COM\_RC\_OVERRIDE 已启用）。
